<md-content layout-padding>

    <form name="recipeForm">
        <md-card>
            <div layout-padding layout="row">
                <div flex="10">
                    <ng-md-icon style="fill:#082D3F" icon="local_restaurant" size="96"></ng-md-icon>
                </div>

                <div layout-padding layout="column" flex>
                    <md-input-container>
                        <label translate>Name</label>
                        <input ng-model="vm.recipe.nomenclature[vm.currentLanguage].name"
                               ng-disabled="!!vm.readOnlyMode">
                    </md-input-container>

                    <md-chips ng-model="vm.recipe.fundamentals.tags" readonly="!!vm.readOnlyMode">
                        <md-chip-template>{{$chip | uppercase}}</md-chip-template>
                    </md-chips>
                </div>

            </div>
        </md-card>

        <md-tabs class="md-primary" md-dynamic-height md-border-bottom md-selected="selectedTab"
                 md-align-tabs="{{data.bottom ? 'bottom' : 'top'}}">

            <md-tab id="info">
                <md-tab-label translate>MAIN INFO</md-tab-label>
                <md-tab-body>
                    <md-card layout-padding>

                        <md-input-container>
                            <label translate>Number of Servings</label>
                            <input type="number" step="1" ng-model="vm.recipe.fundamentals.numberOfServings"
                                   ng-disabled="!!vm.readOnlyMode">
                        </md-input-container>

                        <md-input-container>
                            <label translate>Preparation Time</label>
                            <input type="number" step="1"
                                   ng-model="vm.recipe.fundamentals.preparationTimeMinutes"
                                   ng-disabled="!!vm.readOnlyMode">
                        </md-input-container>

                        <md-input-container>
                            <label translate>Description</label>
                            <input ng-model="vm.recipe.nomenclature[vm.currentLanguage].desc"
                                   ng-disabled="!!vm.readOnlyMode">
                        </md-input-container>

                    </md-card>
                </md-tab-body>
            </md-tab>

            <md-tab id="info">
                <md-tab-label translate>Ingredients</md-tab-label>
                <md-tab-body>
                    <md-card layout-padding>
                        <md-list layout="column" flex>
                            <md-list-item ng-repeat="ingredient in vm.recipe.ingredients">
                                <div layout="row" flex>
                                    <md-input-container class="md-icon-float md-block">
                                        <label translate>Name</label>
                                        <ng-md-icon icon="delete" style="fill:#082D3F" ng-show="!vm.readOnlyMode"
                                                    ng-click="vm.deleteIngredient(ingredient.id)"></ng-md-icon>
                                        <input ng-model="ingredient.id" ng-disabled="!!vm.readOnlyMode">
                                    </md-input-container>
                                    <md-input-container ng-show="ingredient.unit!='x'">
                                        <label translate>Amount</label>
                                        <input ng-model="ingredient.amount" type="number"
                                               ng-disabled="!!vm.readOnlyMode">
                                    </md-input-container>
                                    <md-input-container>
                                        <label translate>Unit</label>
                                        <md-select ng-model="ingredient.unit" ng-disabled="!!vm.readOnlyMode">
                                            <md-option ng-repeat="(key, value) in vm.units" value="{{key}}">
                                                {{value}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                </div>
                            </md-list-item>
                            <md-list-item ng-show="!vm.readOnlyMode">
                                <ng-md-icon icon="add_circle" style="fill:#082D3F" ng-show="!vm.readOnlyMode"
                                            ng-click="vm.addIngredient()"></ng-md-icon>
                            </md-list-item>
                        </md-list>
                    </md-card>
                </md-tab-body>
            </md-tab>

            <md-tab id="info">
                <md-tab-label translate>Steps</md-tab-label>
                <md-tab-body>
                    <md-card layout-padding>
                        <md-list layout="column" flex>
                            <md-list-item
                                    ng-repeat="step in vm.recipe.nomenclature[vm.currentLanguage].steps | orderBy:'number'">
                                <div layout="row" flex>
                                    <ng-md-icon icon="delete" style="fill:#082D3F" ng-show="!vm.readOnlyMode"
                                                ng-click="vm.deleteStep(step.number)"></ng-md-icon>
                                    <md-input-container class="md-icon-float md-block" flex>
                                        <label>
                                            <translate>Step</translate> {{$index+1}}</label>

                                <textarea ng-model="step.desc" ng-disabled="!!vm.readOnlyMode" columns="1"
                                          md-maxlength="500"></textarea>
                                    </md-input-container>
                                </div>
                            </md-list-item>
                            <md-list-item ng-show="!vm.readOnlyMode">
                                <ng-md-icon icon="add_circle" style="fill:#082D3F" ng-show="!vm.readOnlyMode"
                                            ng-click="vm.addStep()"></ng-md-icon>
                            </md-list-item>
                        </md-list>
                    </md-card>
                </md-tab-body>
            </md-tab>

            <md-tab id="info">
                <md-tab-label translate>Nutritional Info</md-tab-label>
                <md-tab-body>
                    <md-card layout-padding>


                    </md-card>
                </md-tab-body>
            </md-tab>

        </md-tabs>

        <div layout="row" flex>
            <md-button ng-click="vm.readOnlyMode=false" ng-show="vm.readOnlyMode"
                       class="md-raised md-primary" translate>
                Edit
            </md-button>
            <md-button ng-click="vm.saveRecipe()" ng-show="!vm.readOnlyMode"
                       class="md-raised md-primary" translate>
                Save
            </md-button>
            <md-button ng-click="vm.cancel()" ng-show="!vm.readOnlyMode"
                       class="md-raised md-primary" translate>
                Cancel
            </md-button>
        </div>
    </form>

</md-content>
